No need to reinvent the wheel. Here you can find useful algorithms to ease your job.